<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Callback</title>
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
            integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
            crossorigin="anonymous"
        />
    </head>
    <body class="pt-5">
        <div class="container">
            <div id="code-error" class="alert alert-danger d-none">No code found</div>

            <form
                action="http://localhost:8080/auth/realms/master/protocol/openid-connect/token"
                method="post"
                id="form"
            >
                <div class="mb-2">
                    <label for="client_id">client_id</label>
                    <input type="text" value="test1" name="client_id" class="form-control" id="client_id" />
                </div>
                <div class="mb-2">
                    <label for="grant_type">grant_type</label>
                    <input
                        type="text"
                        value="authorization_code"
                        name="grant_type"
                        class="form-control"
                        id="grant_type"
                    />
                </div>
                <div class="mb-2">
                    <label for="code">code</label>
                    <input type="text" value="code" name="code" class="form-control" id="code" />
                </div>
                <div class="mb-2">
                    <label for="redirect_uri">redirect_uri</label>
                    <input
                        type="text"
                        value="http://localhost:5500/callback.html"
                        name="redirect_uri"
                        class="form-control"
                        id="redirect_uri"
                    />
                </div>

                <div class="mt-3 text-end">
                    <a href="/index.html" class="btn btn-secondary">Zur√ºck zu Auth</a>
                    <button type="submit" class="btn btn-primary">Token anfordern</button>
                </div>
            </form>
        </div>
    </body>

    <script>
        const urlSearchParams = new URLSearchParams(window.location.search);
        const params = Object.fromEntries(urlSearchParams.entries());
        //console.log(params);

        const code = params.code;
        if (code) {
            document.querySelector('#code').value = code;
        } else {
            document.querySelector('#code-error').classList.remove('d-none');
        }
    </script>
</html>
